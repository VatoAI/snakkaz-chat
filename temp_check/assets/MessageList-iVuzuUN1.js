import{j as p}from"./vendor-ui-DJT7aDMV.js";import{r as ue,H as L,i as en}from"./vendor-react-CkjGjP8g.js";import{a as tn,c as Se}from"./index-DqZGoT8B.js";import{B as Ue}from"./button-DFN2cwgL.js";import{D as on,c as nn,d as rn}from"./avatar-B-kwyh3e.js";import{Q as sn,d as ln,n as cn,al as an,b as un,am as dn,an as fn,T as hn,ao as mn,m as pn,G as Ct}from"./vendor-utils-BiRAyoyP.js";import{n as gn}from"./nb-xAaIZxs7.js";import"./vendor-supabase-0rZ8WFOd.js";typeof window<"u"&&typeof process>"u"&&(window.process={env:{}});const xn=ue.createContext({user:null,isLoading:!0,error:null,signIn:async()=>{},signOut:async()=>{},signUp:async()=>{},resetPassword:async()=>{},updateProfile:async()=>{},updatePassword:async()=>{},enableEncryption:async()=>{},upgradeToPremuim:async()=>{}}),vn=()=>ue.useContext(xn),In=["ðŸ‘","â¤ï¸","ðŸ˜‚","ðŸ˜®","ðŸ˜¢","ðŸ™","ðŸ”¥","ðŸŽ‰"],Tn=({message:e,isOwn:t,variant:o,isRead:n=!1,showAvatar:r=!0,senderName:i,senderAvatarUrl:l,isEncrypted:s=!1,ephemeral:c=!1,expiresAt:a=null,onEdit:h,onDelete:w,onReply:m,onReactionSelect:x,onExpired:C,disableActions:I=!1,showStatus:g=!0})=>{const{toast:d}=tn(),{user:u}=vn(),[b,k]=ue.useState(null),[v,f]=ue.useState(!1),H=ue.useRef(null),j=new Date(e.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),R=new Date(e.timestamp).toLocaleDateString(),B=sn(new Date(e.timestamp),{addSuffix:!0,locale:gn});ue.useEffect(()=>{if(!c||!a)return;const F=()=>{const U=new Date,ce=new Date(a).getTime()-U.getTime();if(ce<=0){k("UtlÃ¸pt"),C&&C(e.id);return}const ee=Math.floor(ce/1e3);ee<60?k(`${ee}s`):ee<3600?k(`${Math.floor(ee/60)}m`):ee<86400?k(`${Math.floor(ee/3600)}t`):k(`${Math.floor(ee/86400)}d`)};F();const z=setInterval(F,1e3);return()=>clearInterval(z)},[c,a,e.id,C]);const M=()=>{e.text&&(navigator.clipboard.writeText(e.text),d({title:"Tekst kopiert",description:"Meldingsteksten er kopiert til utklippstavlen"}))},D=o!=="direct"&&!t;return p.jsxs("div",{ref:H,className:Se("group relative flex items-start gap-3 py-2 px-4 rounded-lg hover:bg-cyberdark-800/30 transition-colors duration-200",t?"justify-end":"justify-start"),onMouseEnter:()=>f(!0),onMouseLeave:()=>f(!1),children:[r&&!t&&p.jsx("div",{className:"flex-shrink-0",children:l?p.jsx("div",{className:"h-8 w-8 rounded-full overflow-hidden",children:p.jsx("img",{src:l,alt:i||"User",className:"h-full w-full object-cover"})}):p.jsx("div",{className:"h-8 w-8 rounded-full bg-cybergold-900/30 flex items-center justify-center text-sm font-semibold text-cybergold-400",children:i?i.charAt(0).toUpperCase():"U"})}),p.jsxs("div",{className:Se("relative max-w-[75%] flex flex-col",t?"items-end":"items-start"),children:[D&&i&&p.jsx("div",{className:"text-xs font-medium text-cybergold-500 mb-1",children:i}),e.replyToId&&e.replyToPreview&&p.jsxs("div",{className:Se("mb-1 px-3 py-1.5 rounded border-l-2 text-sm",t?"bg-cybergold-950/30 border-cybergold-700/50 text-cybergold-300":"bg-cyberdark-800/80 border-cyberdark-600 text-cyberdark-300"),children:[p.jsx("div",{className:"text-xs font-medium text-cybergold-500",children:e.replyToSenderName||"Someone"}),p.jsx("div",{className:"text-xs truncate text-cybergold-400",children:e.replyToPreview})]}),p.jsxs("div",{className:Se("px-4 py-2 rounded-2xl",t?"bg-cybergold-900/30 text-cybergold-100 rounded-tr-none":"bg-cyberdark-800 text-cyberdark-100 rounded-tl-none"),children:[e.text&&p.jsx("div",{className:Se("whitespace-pre-wrap text-sm",e.isEdited&&"mb-1"),children:e.text}),e.mediaUrl&&p.jsx("div",{className:Se("rounded-lg overflow-hidden mt-1",e.text&&"mt-2"),children:e.mediaType==="image"?p.jsx("img",{src:e.mediaUrl,alt:"Attached media",className:"max-w-full max-h-64 rounded-lg"}):e.mediaType==="video"?p.jsx("video",{src:e.mediaUrl,controls:!0,className:"max-w-full max-h-64 rounded-lg"}):null}),e.fileUrl&&p.jsxs("div",{className:"mt-2 p-2 bg-cyberdark-700/50 rounded-md flex items-center",children:[p.jsx("div",{className:"text-xs text-cybergold-300 truncate",children:e.fileName||"Attached File"}),p.jsx(Ue,{variant:"ghost",size:"icon",className:"h-6 w-6 ml-auto",onClick:()=>window.open(e.fileUrl,"_blank"),children:p.jsx("span",{className:"sr-only",children:"Download"})})]}),e.isEdited&&p.jsx("div",{className:"text-xs text-cybergold-600 italic",children:"redigert"}),s&&p.jsxs("div",{className:"text-xs text-emerald-500 flex items-center gap-1 mt-0.5",children:[p.jsx(ln,{className:"h-3 w-3"}),p.jsx("span",{children:"Kryptert"})]}),c&&b&&p.jsxs("div",{className:"text-xs text-amber-400/80 flex items-center gap-1 mt-0.5",children:[p.jsx(cn,{className:"h-3 w-3"}),p.jsx("span",{children:b})]})]}),p.jsxs("div",{className:"text-xs text-cybergold-600 mt-1 flex items-center gap-1",children:[p.jsx("span",{title:`${R} ${j}`,children:B}),t&&g&&p.jsx(p.Fragment,{children:n?p.jsx(an,{className:"h-3 w-3 text-cybergold-400"}):p.jsx(un,{className:"h-3 w-3 text-cybergold-600"})})]}),e.reactions&&e.reactions.length>0&&p.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:e.reactions.map((F,z)=>p.jsxs("div",{className:"bg-cyberdark-800 px-1.5 py-0.5 rounded-full text-xs flex items-center gap-0.5",children:[p.jsx("span",{children:F.emoji}),F.count>1&&p.jsx("span",{className:"text-cybergold-500",children:F.count})]},`${F.emoji}-${z}`))})]}),!I&&v&&p.jsxs("div",{className:Se("absolute top-2 flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",t?"left-2":"right-2"),children:[m&&p.jsxs(Ue,{variant:"ghost",size:"icon",className:"h-7 w-7 rounded-full bg-cyberdark-800 hover:bg-cyberdark-700",onClick:()=>m(e),children:[p.jsx(dn,{className:"h-3.5 w-3.5"}),p.jsx("span",{className:"sr-only",children:"Reply"})]}),t&&h&&p.jsxs(Ue,{variant:"ghost",size:"icon",className:"h-7 w-7 rounded-full bg-cyberdark-800 hover:bg-cyberdark-700",onClick:()=>h(e),children:[p.jsx(fn,{className:"h-3.5 w-3.5"}),p.jsx("span",{className:"sr-only",children:"Edit"})]}),t&&w&&p.jsxs(Ue,{variant:"ghost",size:"icon",className:"h-7 w-7 rounded-full bg-cyberdark-800 hover:bg-cyberdark-700 hover:text-red-400",onClick:()=>w(e.id),children:[p.jsx(hn,{className:"h-3.5 w-3.5"}),p.jsx("span",{className:"sr-only",children:"Delete"})]}),x&&p.jsxs(on,{children:[p.jsx(nn,{asChild:!0,children:p.jsxs(Ue,{variant:"ghost",size:"icon",className:"h-7 w-7 rounded-full bg-cyberdark-800 hover:bg-cyberdark-700",children:[p.jsx("span",{className:"text-sm",children:"ðŸ˜€"}),p.jsx("span",{className:"sr-only",children:"Add reaction"})]})}),p.jsx(rn,{className:"bg-cyberdark-800 border-cyberdark-700",children:p.jsx("div",{className:"flex flex-wrap gap-2 p-2 max-w-[200px]",children:In.map(F=>p.jsx("button",{className:"text-lg hover:bg-cyberdark-700 p-1 rounded",onClick:()=>{x(e.id,F)},children:F},F))})})]}),e.text&&p.jsxs(Ue,{variant:"ghost",size:"icon",className:"h-7 w-7 rounded-full bg-cyberdark-800 hover:bg-cyberdark-700",onClick:M,children:[p.jsx(mn,{className:"h-3.5 w-3.5"}),p.jsx("span",{className:"sr-only",children:"Copy text"})]})]}),r&&t&&p.jsx("div",{className:"w-8 flex-shrink-0"})]})},It=0,Me=1,qe=2,To=4;function Qt(e){return()=>e}function wn(e){e()}function wo(e,t){return o=>e(t(o))}function eo(e,t){return()=>e(t)}function Sn(e,t){return o=>e(t,o)}function Dt(e){return e!==void 0}function bn(...e){return()=>{e.map(wn)}}function Ke(){}function Tt(e,t){return t(e),e}function yn(e,t){return t(e)}function X(...e){return e}function q(e,t){return e(Me,t)}function W(e,t){e(It,t)}function Ft(e){e(qe)}function se(e){return e(To)}function N(e,t){return q(e,Sn(t,It))}function Ce(e,t){const o=e(Me,n=>{o(),t(n)});return o}function to(e){let t,o;return n=>r=>{t=r,o&&clearTimeout(o),o=setTimeout(()=>{n(t)},e)}}function So(e,t){return e===t}function Y(e=So){let t;return o=>n=>{e(t,n)||(t=n,o(n))}}function P(e){return t=>o=>{e(o)&&t(o)}}function E(e){return t=>wo(t,e)}function be(e){return t=>()=>{t(e)}}function T(e,...t){const o=Cn(...t);return(n,r)=>{switch(n){case qe:Ft(e);return;case Me:return q(e,o(r))}}}function ye(e,t){return o=>n=>{o(t=e(t,n))}}function $e(e){return t=>o=>{e>0?e--:t(o)}}function je(e){let t=null,o;return n=>r=>{t=r,!o&&(o=setTimeout(()=>{o=void 0,n(t)},e))}}function V(...e){const t=new Array(e.length);let o=0,n=null;const r=Math.pow(2,e.length)-1;return e.forEach((i,l)=>{const s=Math.pow(2,l);q(i,c=>{const a=o;o=o|s,t[l]=c,a!==r&&o===r&&n&&(n(),n=null)})}),i=>l=>{const s=()=>{i([l].concat(t))};o===r?s():n=s}}function Cn(...e){return t=>e.reduceRight(yn,t)}function Hn(e){let t,o;const n=()=>t==null?void 0:t();return function(r,i){switch(r){case Me:return i?o===i?void 0:(n(),o=i,t=q(e,i),t):(n(),Ke);case qe:n(),o=null;return}}}function S(e){let t=e;const o=_();return(n,r)=>{switch(n){case It:t=r;break;case Me:{r(t);break}case To:return t}return o(n,r)}}function le(e,t){return Tt(S(t),o=>N(e,o))}function _(){const e=[];return(t,o)=>{switch(t){case It:e.slice().forEach(n=>{n(o)});return;case qe:e.splice(0,e.length);return;case Me:return e.push(o),()=>{const n=e.indexOf(o);n>-1&&e.splice(n,1)}}}}function me(e){return Tt(_(),t=>N(e,t))}function $(e,t=[],{singleton:o}={singleton:!0}){return{constructor:e,dependencies:t,id:Rn(),singleton:o}}const Rn=()=>Symbol();function kn(e){const t=new Map,o=({constructor:n,dependencies:r,id:i,singleton:l})=>{if(l&&t.has(i))return t.get(i);const s=n(r.map(c=>o(c)));return l&&t.set(i,s),s};return o(e)}function oe(...e){const t=_(),o=new Array(e.length);let n=0;const r=Math.pow(2,e.length)-1;return e.forEach((i,l)=>{const s=Math.pow(2,l);q(i,c=>{o[l]=c,n=n|s,n===r&&W(t,o)})}),function(i,l){switch(i){case qe:{Ft(t);return}case Me:return n===r&&l(o),q(t,l)}}}function A(e,t=So){return T(e,Y(t))}function oo(...e){return function(t,o){switch(t){case qe:return;case Me:return bn(...e.map(n=>q(n,o)))}}}var pe=(e=>(e[e.DEBUG=0]="DEBUG",e[e.INFO=1]="INFO",e[e.WARN=2]="WARN",e[e.ERROR=3]="ERROR",e))(pe||{});const zn={0:"debug",3:"error",1:"log",2:"warn"},jn=()=>typeof globalThis>"u"?window:globalThis,Be=$(()=>{const e=S(3);return{log:S((t,o,n=1)=>{var r;const i=(r=jn().VIRTUOSO_LOG_LEVEL)!=null?r:se(e);n>=i&&console[zn[n]]("%creact-virtuoso: %c%s %o","color: #0253b3; font-weight: bold","color: initial",t,o)}),logLevel:e}},[],{singleton:!0});function Ae(e,t,o){return Pt(e,t,o).callbackRef}function Pt(e,t,o){const n=L.useRef(null);let r=l=>{};const i=L.useMemo(()=>typeof ResizeObserver<"u"?new ResizeObserver(l=>{const s=()=>{const c=l[0].target;c.offsetParent!==null&&e(c)};o?s():requestAnimationFrame(s)}):null,[e,o]);return r=l=>{l&&t?(i==null||i.observe(l),n.current=l):(n.current&&(i==null||i.unobserve(n.current)),n.current=null)},{callbackRef:r,ref:n}}function En(e,t,o,n,r,i,l,s,c){const a=L.useCallback(h=>{const w=Mn(h.children,t,s?"offsetWidth":"offsetHeight",r);let m=h.parentElement;for(;!m.dataset.virtuosoScroller;)m=m.parentElement;const x=m.lastElementChild.dataset.viewportType==="window";let C;x&&(C=m.ownerDocument.defaultView);const I=l?s?l.scrollLeft:l.scrollTop:x?s?C.scrollX||C.document.documentElement.scrollLeft:C.scrollY||C.document.documentElement.scrollTop:s?m.scrollLeft:m.scrollTop,g=l?s?l.scrollWidth:l.scrollHeight:x?s?C.document.documentElement.scrollWidth:C.document.documentElement.scrollHeight:s?m.scrollWidth:m.scrollHeight,d=l?s?l.offsetWidth:l.offsetHeight:x?s?C.innerWidth:C.innerHeight:s?m.offsetWidth:m.offsetHeight;n({scrollHeight:g,scrollTop:Math.max(I,0),viewportHeight:d}),i==null||i(s?no("column-gap",getComputedStyle(h).columnGap,r):no("row-gap",getComputedStyle(h).rowGap,r)),w!==null&&e(w)},[e,t,r,i,l,n,s]);return Pt(a,o,c)}function Mn(e,t,o,n){const r=e.length;if(r===0)return null;const i=[];for(let l=0;l<r;l++){const s=e.item(l);if(s.dataset.index===void 0)continue;const c=parseInt(s.dataset.index),a=parseFloat(s.dataset.knownSize),h=t(s,o);if(h===0&&n("Zero-sized element, this should not happen",{child:s},pe.ERROR),h===a)continue;const w=i[i.length-1];i.length===0||w.size!==h||w.endIndex!==c-1?i.push({endIndex:c,size:h,startIndex:c}):i[i.length-1].endIndex++}return i}function no(e,t,o){return t!=="normal"&&!(t!=null&&t.endsWith("px"))&&o(`${e} was not resolved to pixel value correctly`,t,pe.WARN),t==="normal"?0:parseInt(t??"0",10)}function bo(e,t,o){const n=L.useRef(null),r=L.useCallback(c=>{if(!(c!=null&&c.offsetParent))return;const a=c.getBoundingClientRect(),h=a.width;let w,m;if(t){const x=t.getBoundingClientRect(),C=a.top-x.top;m=x.height-Math.max(0,C),w=C+t.scrollTop}else{const x=l.current.ownerDocument.defaultView;m=x.innerHeight-Math.max(0,a.top),w=a.top+x.scrollY}n.current={offsetTop:w,visibleHeight:m,visibleWidth:h},e(n.current)},[e,t]),{callbackRef:i,ref:l}=Pt(r,!0,o),s=L.useCallback(()=>{r(l.current)},[r,l]);return L.useEffect(()=>{var c;if(t){t.addEventListener("scroll",s);const a=new ResizeObserver(()=>{requestAnimationFrame(s)});return a.observe(t),()=>{t.removeEventListener("scroll",s),a.unobserve(t)}}else{const a=(c=l.current)==null?void 0:c.ownerDocument.defaultView;return a==null||a.addEventListener("scroll",s),a==null||a.addEventListener("resize",s),()=>{a==null||a.removeEventListener("scroll",s),a==null||a.removeEventListener("resize",s)}}},[s,t,l]),i}const de=$(()=>{const e=_(),t=_(),o=S(0),n=_(),r=S(0),i=_(),l=_(),s=S(0),c=S(0),a=S(0),h=S(0),w=_(),m=_(),x=S(!1),C=S(!1),I=S(!1);return N(T(e,E(({scrollTop:g})=>g)),t),N(T(e,E(({scrollHeight:g})=>g)),l),N(t,r),{deviation:o,fixedFooterHeight:a,fixedHeaderHeight:c,footerHeight:h,headerHeight:s,horizontalDirection:C,scrollBy:m,scrollContainerState:e,scrollHeight:l,scrollingInProgress:x,scrollTo:w,scrollTop:t,skipAnimationFrameInResizeObserver:I,smoothScrollTargetReached:n,statefulScrollTop:r,viewportHeight:i}},[],{singleton:!0}),et={lvl:0};function yo(e,t){const o=e.length;if(o===0)return[];let{index:n,value:r}=t(e[0]);const i=[];for(let l=1;l<o;l++){const{index:s,value:c}=t(e[l]);i.push({end:s-1,start:n,value:r}),n=s,r=c}return i.push({end:1/0,start:n,value:r}),i}function K(e){return e===et}function tt(e,t){if(!K(e))return t===e.k?e.v:t<e.k?tt(e.l,t):tt(e.r,t)}function Te(e,t,o="k"){if(K(e))return[-1/0,void 0];if(Number(e[o])===t)return[e.k,e.v];if(Number(e[o])<t){const n=Te(e.r,t,o);return n[0]===-1/0?[e.k,e.v]:n}return Te(e.l,t,o)}function he(e,t,o){return K(e)?Ro(t,o,1):t===e.k?te(e,{k:t,v:o}):t<e.k?ro(te(e,{l:he(e.l,t,o)})):ro(te(e,{r:he(e.r,t,o)}))}function _e(){return et}function wt(e,t,o){if(K(e))return[];const n=Te(e,t)[0];return Bn(Mt(e,n,o))}function Et(e,t){if(K(e))return et;const{k:o,l:n,r}=e;if(t===o){if(K(n))return r;if(K(r))return n;{const[i,l]=Ho(n);return ht(te(e,{k:i,l:Co(n),v:l}))}}else return t<o?ht(te(e,{l:Et(n,t)})):ht(te(e,{r:Et(r,t)}))}function Pe(e){return K(e)?[]:[...Pe(e.l),{k:e.k,v:e.v},...Pe(e.r)]}function Mt(e,t,o){if(K(e))return[];const{k:n,l:r,r:i,v:l}=e;let s=[];return n>t&&(s=s.concat(Mt(r,t,o))),n>=t&&n<=o&&s.push({k:n,v:l}),n<=o&&(s=s.concat(Mt(i,t,o))),s}function ht(e){const{l:t,lvl:o,r:n}=e;if(n.lvl>=o-1&&t.lvl>=o-1)return e;if(o>n.lvl+1){if(Ht(t))return ko(te(e,{lvl:o-1}));if(!K(t)&&!K(t.r))return te(t.r,{l:te(t,{r:t.r.l}),lvl:o,r:te(e,{l:t.r.r,lvl:o-1})});throw new Error("Unexpected empty nodes")}else{if(Ht(e))return Bt(te(e,{lvl:o-1}));if(!K(n)&&!K(n.l)){const r=n.l,i=Ht(r)?n.lvl-1:n.lvl;return te(r,{l:te(e,{lvl:o-1,r:r.l}),lvl:r.lvl+1,r:Bt(te(n,{l:r.r,lvl:i}))})}else throw new Error("Unexpected empty nodes")}}function te(e,t){return Ro(t.k!==void 0?t.k:e.k,t.v!==void 0?t.v:e.v,t.lvl!==void 0?t.lvl:e.lvl,t.l!==void 0?t.l:e.l,t.r!==void 0?t.r:e.r)}function Co(e){return K(e.r)?e.l:ht(te(e,{r:Co(e.r)}))}function Ht(e){return K(e)||e.lvl>e.r.lvl}function Ho(e){return K(e.r)?[e.k,e.v]:Ho(e.r)}function Ro(e,t,o,n=et,r=et){return{k:e,l:n,lvl:o,r,v:t}}function ro(e){return Bt(ko(e))}function ko(e){const{l:t}=e;return!K(t)&&t.lvl===e.lvl?te(t,{r:te(e,{l:t.r})}):e}function Bt(e){const{lvl:t,r:o}=e;return!K(o)&&!K(o.r)&&o.lvl===t&&o.r.lvl===t?te(o,{l:te(e,{r:o.l}),lvl:t+1}):e}function Bn(e){return yo(e,({k:t,v:o})=>({index:t,value:o}))}function zo(e,t){return!!(e&&e.startIndex===t.startIndex&&e.endIndex===t.endIndex)}function ot(e,t){return!!(e&&e[0]===t[0]&&e[1]===t[1])}const At=$(()=>({recalcInProgress:S(!1)}),[],{singleton:!0});function jo(e,t,o){return e[pt(e,t,o)]}function pt(e,t,o,n=0){let r=e.length-1;for(;n<=r;){const i=Math.floor((n+r)/2),l=e[i],s=o(l,t);if(s===0)return i;if(s===-1){if(r-n<2)return i-1;r=i-1}else{if(r===n)return i;n=i+1}}throw new Error(`Failed binary finding record in array - ${e.join(",")}, searched for ${t}`)}function Ln(e,t,o,n){const r=pt(e,t,n),i=pt(e,o,n,r);return e.slice(r,i+1)}function Ee(e,t){return Math.round(e.getBoundingClientRect()[t])}function St(e){return!K(e.groupOffsetTree)}function Ot({index:e},t){return t===e?0:t<e?-1:1}function Nn(){return{groupIndices:[],groupOffsetTree:_e(),lastIndex:0,lastOffset:0,lastSize:0,offsetTree:[],sizeTree:_e()}}function Dn(e,t){let o=K(e)?0:1/0;for(const n of t){const{endIndex:r,size:i,startIndex:l}=n;if(o=Math.min(o,l),K(e)){e=he(e,0,i);continue}const s=wt(e,l-1,r+1);if(s.some(Gn(n)))continue;let c=!1,a=!1;for(const{end:h,start:w,value:m}of s)c?(r>=w||i===m)&&(e=Et(e,w)):(a=m!==i,c=!0),h>r&&r>=w&&m!==i&&(e=he(e,r+1,m));a&&(e=he(e,l,i))}return[e,o]}function Fn(e){return typeof e.groupIndex<"u"}function Pn({offset:e},t){return t===e?0:t<e?-1:1}function nt(e,t,o){if(t.length===0)return 0;const{index:n,offset:r,size:i}=jo(t,e,Ot),l=e-n,s=i*l+(l-1)*o+r;return s>0?s+o:s}function Eo(e,t){if(!St(t))return e;let o=0;for(;t.groupIndices[o]<=e+o;)o++;return e+o}function Mo(e,t,o){if(Fn(e))return t.groupIndices[e.groupIndex]+1;{const n=e.index==="LAST"?o:e.index;let r=Eo(n,t);return r=Math.max(0,r,Math.min(o,r)),r}}function An(e,t,o,n=0){return n>0&&(t=Math.max(t,jo(e,n,Ot).offset)),yo(Ln(e,t,o,Pn),Vn)}function On(e,[t,o,n,r]){t.length>0&&n("received item sizes",t,pe.DEBUG);const i=e.sizeTree;let l=i,s=0;if(o.length>0&&K(i)&&t.length===2){const m=t[0].size,x=t[1].size;l=o.reduce((C,I)=>he(he(C,I,m),I+1,x),l)}else[l,s]=Dn(l,t);if(l===i)return e;const{lastIndex:c,lastOffset:a,lastSize:h,offsetTree:w}=Lt(e.offsetTree,s,l,r);return{groupIndices:o,groupOffsetTree:o.reduce((m,x)=>he(m,x,nt(x,w,r)),_e()),lastIndex:c,lastOffset:a,lastSize:h,offsetTree:w,sizeTree:l}}function Wn(e){return Pe(e).map(({k:t,v:o},n,r)=>{const i=r[n+1];return{endIndex:i?i.k-1:1/0,size:o,startIndex:t}})}function io(e,t){let o=0,n=0;for(;o<e;)o+=t[n+1]-t[n]-1,n++;return n-(o===e?0:1)}function Lt(e,t,o,n){let r=e,i=0,l=0,s=0,c=0;if(t!==0){c=pt(r,t-1,Ot),s=r[c].offset;const a=Te(o,t-1);i=a[0],l=a[1],r.length&&r[c].size===Te(o,t)[1]&&(c-=1),r=r.slice(0,c+1)}else r=[];for(const{start:a,value:h}of wt(o,t,1/0)){const w=a-i,m=w*l+s+w*n;r.push({index:a,offset:m,size:h}),i=a,s=m,l=h}return{lastIndex:i,lastOffset:s,lastSize:l,offsetTree:r}}function Vn(e){return{index:e.index,value:e}}function Gn(e){const{endIndex:t,size:o,startIndex:n}=e;return r=>r.start===n&&(r.end===t||r.end===1/0)&&r.value===o}const Un={offsetHeight:"height",offsetWidth:"width"},He=$(([{log:e},{recalcInProgress:t}])=>{const o=_(),n=_(),r=le(n,0),i=_(),l=_(),s=S(0),c=S([]),a=S(void 0),h=S(void 0),w=S((v,f)=>Ee(v,Un[f])),m=S(void 0),x=S(0),C=Nn(),I=le(T(o,V(c,e,x),ye(On,C),Y()),C),g=le(T(c,Y(),ye((v,f)=>({current:f,prev:v.current}),{current:[],prev:[]}),E(({prev:v})=>v)),[]);N(T(c,P(v=>v.length>0),V(I,x),E(([v,f,H])=>{const j=v.reduce((R,B,M)=>he(R,B,nt(B,f.offsetTree,H)||M),_e());return{...f,groupIndices:v,groupOffsetTree:j}})),I),N(T(n,V(I),P(([v,{lastIndex:f}])=>v<f),E(([v,{lastIndex:f,lastSize:H}])=>[{endIndex:f,size:H,startIndex:v}])),o),N(a,h);const d=le(T(a,E(v=>v===void 0)),!0);N(T(h,P(v=>v!==void 0&&K(se(I).sizeTree)),E(v=>[{endIndex:0,size:v,startIndex:0}])),o);const u=me(T(o,V(I),ye(({sizes:v},[f,H])=>({changed:H!==v,sizes:H}),{changed:!1,sizes:C}),E(v=>v.changed)));q(T(s,ye((v,f)=>({diff:v.prev-f,prev:f}),{diff:0,prev:0}),E(v=>v.diff)),v=>{const{groupIndices:f}=se(I);if(v>0)W(t,!0),W(i,v+io(v,f));else if(v<0){const H=se(g);H.length>0&&(v-=io(-v,H)),W(l,v)}}),q(T(s,V(e)),([v,f])=>{v<0&&f("`firstItemIndex` prop should not be set to less than zero. If you don't know the total count, just use a very high value",{firstItemIndex:s},pe.ERROR)});const b=me(i);N(T(i,V(I),E(([v,f])=>{const H=f.groupIndices.length>0,j=[],R=f.lastSize;if(H){const B=tt(f.sizeTree,0);let M=0,D=0;for(;M<v;){const z=f.groupIndices[D],U=f.groupIndices.length===D+1?1/0:f.groupIndices[D+1]-z-1;j.push({endIndex:z,size:B,startIndex:z}),j.push({endIndex:z+1+U-1,size:R,startIndex:z+1}),D++,M+=U+1}const F=Pe(f.sizeTree);return M!==v&&F.shift(),F.reduce((z,{k:U,v:ne})=>{let ce=z.ranges;return z.prevSize!==0&&(ce=[...z.ranges,{endIndex:U+v-1,size:z.prevSize,startIndex:z.prevIndex}]),{prevIndex:U+v,prevSize:ne,ranges:ce}},{prevIndex:v,prevSize:0,ranges:j}).ranges}return Pe(f.sizeTree).reduce((B,{k:M,v:D})=>({prevIndex:M+v,prevSize:D,ranges:[...B.ranges,{endIndex:M+v-1,size:B.prevSize,startIndex:B.prevIndex}]}),{prevIndex:0,prevSize:R,ranges:[]}).ranges})),o);const k=me(T(l,V(I,x),E(([v,{offsetTree:f},H])=>{const j=-v;return nt(j,f,H)})));return N(T(l,V(I,x),E(([v,f,H])=>{if(f.groupIndices.length>0){if(K(f.sizeTree))return f;let j=_e();const R=se(g);let B=0,M=0,D=0;for(;B<-v;){D=R[M];const F=R[M+1]-D-1;M++,B+=F+1}if(j=Pe(f.sizeTree).reduce((F,{k:z,v:U})=>he(F,Math.max(0,z+v),U),j),B!==-v){const F=tt(f.sizeTree,D);j=he(j,0,F);const z=Te(f.sizeTree,-v+1)[1];j=he(j,1,z)}return{...f,sizeTree:j,...Lt(f.offsetTree,0,j,H)}}else{const j=Pe(f.sizeTree).reduce((R,{k:B,v:M})=>he(R,Math.max(0,B+v),M),_e());return{...f,sizeTree:j,...Lt(f.offsetTree,0,j,H)}}})),I),{beforeUnshiftWith:b,data:m,defaultItemSize:h,firstItemIndex:s,fixedItemSize:a,gap:x,groupIndices:c,itemSize:w,listRefresh:u,shiftWith:l,shiftWithOffset:k,sizeRanges:o,sizes:I,statefulTotalCount:r,totalCount:n,trackItemSizes:d,unshiftWith:i}},X(Be,At),{singleton:!0});function _n(e){return e.reduce((t,o)=>(t.groupIndices.push(t.totalCount),t.totalCount+=o+1,t),{groupIndices:[],totalCount:0})}const Bo=$(([{groupIndices:e,sizes:t,totalCount:o},{headerHeight:n,scrollTop:r}])=>{const i=_(),l=_(),s=me(T(i,E(_n)));return N(T(s,E(c=>c.totalCount)),o),N(T(s,E(c=>c.groupIndices)),e),N(T(oe(r,t,n),P(([c,a])=>St(a)),E(([c,a,h])=>Te(a.groupOffsetTree,Math.max(c-h,0),"v")[0]),Y(),E(c=>[c])),l),{groupCounts:i,topItemsIndexes:l}},X(He,de)),Le=$(([{log:e}])=>{const t=S(!1),o=me(T(t,P(n=>n),Y()));return q(t,n=>{n&&se(e)("props updated",{},pe.DEBUG)}),{didMount:o,propsReady:t}},X(Be),{singleton:!0}),$n=typeof document<"u"&&"scrollBehavior"in document.documentElement.style;function Lo(e){const t=typeof e=="number"?{index:e}:e;return t.align||(t.align="start"),(!t.behavior||!$n)&&(t.behavior="auto"),t.offset||(t.offset=0),t}const it=$(([{gap:e,listRefresh:t,sizes:o,totalCount:n},{fixedFooterHeight:r,fixedHeaderHeight:i,footerHeight:l,headerHeight:s,scrollingInProgress:c,scrollTo:a,smoothScrollTargetReached:h,viewportHeight:w},{log:m}])=>{const x=_(),C=_(),I=S(0);let g=null,d=null,u=null;function b(){g&&(g(),g=null),u&&(u(),u=null),d&&(clearTimeout(d),d=null),W(c,!1)}return N(T(x,V(o,w,n,I,s,l,m),V(e,i,r),E(([[k,v,f,H,j,R,B,M],D,F,z])=>{const U=Lo(k),{align:ne,behavior:ce,offset:ee}=U,ve=H-1,fe=Mo(U,v,ve);let ae=nt(fe,v.offsetTree,D)+R;ne==="end"?(ae+=F+Te(v.sizeTree,fe)[1]-f+z,fe===ve&&(ae+=B)):ne==="center"?ae+=(F+Te(v.sizeTree,fe)[1]-f+z)/2:ae-=j,ee&&(ae+=ee);const Ne=Ie=>{b(),Ie?(M("retrying to scroll to",{location:k},pe.DEBUG),W(x,k)):(W(C,!0),M("list did not change, scroll successful",{},pe.DEBUG))};if(b(),ce==="smooth"){let Ie=!1;u=q(t,Ye=>{Ie=Ie||Ye}),g=Ce(h,()=>{Ne(Ie)})}else g=Ce(T(t,qn(150)),Ne);return d=setTimeout(()=>{b()},1200),W(c,!0),M("scrolling from index to",{behavior:ce,index:fe,top:ae},pe.DEBUG),{behavior:ce,top:ae}})),a),{scrollTargetReached:C,scrollToIndex:x,topListHeight:I}},X(He,de,Be),{singleton:!0});function qn(e){return t=>{const o=setTimeout(()=>{t(!1)},e);return n=>{n&&(t(!0),clearTimeout(o))}}}function Wt(e,t){e==0?t():requestAnimationFrame(()=>{Wt(e-1,t)})}function Vt(e,t){const o=t-1;return typeof e=="number"?e:e.index==="LAST"?o:e.index}const st=$(([{defaultItemSize:e,listRefresh:t,sizes:o},{scrollTop:n},{scrollTargetReached:r,scrollToIndex:i},{didMount:l}])=>{const s=S(!0),c=S(0),a=S(!0);return N(T(l,V(c),P(([h,w])=>!!w),be(!1)),s),N(T(l,V(c),P(([h,w])=>!!w),be(!1)),a),q(T(oe(t,l),V(s,o,e,a),P(([[,h],w,{sizeTree:m},x,C])=>h&&(!K(m)||Dt(x))&&!w&&!C),V(c)),([,h])=>{Ce(r,()=>{W(a,!0)}),Wt(4,()=>{Ce(n,()=>{W(s,!0)}),W(i,h)})}),{initialItemFinalLocationReached:a,initialTopMostItemIndex:c,scrolledToInitialItem:s}},X(He,de,it,Le),{singleton:!0});function No(e,t){return Math.abs(e-t)<1.01}const rt="up",Je="down",Kn="none",Yn={atBottom:!1,notAtBottomBecause:"NOT_SHOWING_LAST_ITEM",state:{offsetBottom:0,scrollHeight:0,scrollTop:0,viewportHeight:0}},Xn=0,lt=$(([{footerHeight:e,headerHeight:t,scrollBy:o,scrollContainerState:n,scrollTop:r,viewportHeight:i}])=>{const l=S(!1),s=S(!0),c=_(),a=_(),h=S(4),w=S(Xn),m=le(T(oo(T(A(r),$e(1),be(!0)),T(A(r),$e(1),be(!1),to(100))),Y()),!1),x=le(T(oo(T(o,be(!0)),T(o,be(!1),to(200))),Y()),!1);N(T(oe(A(r),A(w)),E(([u,b])=>u<=b),Y()),s),N(T(s,je(50)),a);const C=me(T(oe(n,A(i),A(t),A(e),A(h)),ye((u,[{scrollHeight:b,scrollTop:k},v,f,H,j])=>{const R=k+v-b>-j,B={scrollHeight:b,scrollTop:k,viewportHeight:v};if(R){let D,F;return k>u.state.scrollTop?(D="SCROLLED_DOWN",F=u.state.scrollTop-k):(D="SIZE_DECREASED",F=u.state.scrollTop-k||u.scrollTopDelta),{atBottom:!0,atBottomBecause:D,scrollTopDelta:F,state:B}}let M;return B.scrollHeight>u.state.scrollHeight?M="SIZE_INCREASED":v<u.state.viewportHeight?M="VIEWPORT_HEIGHT_DECREASING":k<u.state.scrollTop?M="SCROLLING_UPWARDS":M="NOT_FULLY_SCROLLED_TO_LAST_ITEM_BOTTOM",{atBottom:!1,notAtBottomBecause:M,state:B}},Yn),Y((u,b)=>u&&u.atBottom===b.atBottom))),I=le(T(n,ye((u,{scrollHeight:b,scrollTop:k,viewportHeight:v})=>{if(No(u.scrollHeight,b))return{changed:!1,jump:0,scrollHeight:b,scrollTop:k};{const f=b-(k+v)<1;return u.scrollTop!==k&&f?{changed:!0,jump:u.scrollTop-k,scrollHeight:b,scrollTop:k}:{changed:!0,jump:0,scrollHeight:b,scrollTop:k}}},{changed:!1,jump:0,scrollHeight:0,scrollTop:0}),P(u=>u.changed),E(u=>u.jump)),0);N(T(C,E(u=>u.atBottom)),l),N(T(l,je(50)),c);const g=S(Je);N(T(n,E(({scrollTop:u})=>u),Y(),ye((u,b)=>se(x)?{direction:u.direction,prevScrollTop:b}:{direction:b<u.prevScrollTop?rt:Je,prevScrollTop:b},{direction:Je,prevScrollTop:0}),E(u=>u.direction)),g),N(T(n,je(50),be(Kn)),g);const d=S(0);return N(T(m,P(u=>!u),be(0)),d),N(T(r,je(100),V(m),P(([u,b])=>!!b),ye(([u,b],[k])=>[b,k],[0,0]),E(([u,b])=>b-u)),d),{atBottomState:C,atBottomStateChange:c,atBottomThreshold:h,atTopStateChange:a,atTopThreshold:w,isAtBottom:l,isAtTop:s,isScrolling:m,lastJumpDueToItemResize:I,scrollDirection:g,scrollVelocity:d}},X(de)),gt="top",xt="bottom",so="none";function lo(e,t,o){return typeof e=="number"?o===rt&&t===gt||o===Je&&t===xt?e:0:o===rt?t===gt?e.main:e.reverse:t===xt?e.main:e.reverse}function co(e,t){var o;return typeof e=="number"?e:(o=e[t])!=null?o:0}const Gt=$(([{deviation:e,fixedHeaderHeight:t,headerHeight:o,scrollTop:n,viewportHeight:r}])=>{const i=_(),l=S(0),s=S(0),c=S(0),a=le(T(oe(A(n),A(r),A(o),A(i,ot),A(c),A(l),A(t),A(e),A(s)),E(([h,w,m,[x,C],I,g,d,u,b])=>{const k=h-u,v=g+d,f=Math.max(m-k,0);let H=so;const j=co(b,gt),R=co(b,xt);return x-=u,x+=m+d,C+=m+d,C-=u,x>h+v-j&&(H=rt),C<h-f+w+R&&(H=Je),H!==so?[Math.max(k-m-lo(I,gt,H)-j,0),k-f-d+w+lo(I,xt,H)+R]:null}),P(h=>h!=null),Y(ot)),[0,0]);return{increaseViewportBy:s,listBoundary:i,overscan:c,topListHeight:l,visibleRange:a}},X(de),{singleton:!0});function Zn(e,t,o){if(St(t)){const n=Eo(e,t);return[{index:Te(t.groupOffsetTree,n)[0],offset:0,size:0},{data:o==null?void 0:o[0],index:n,offset:0,size:0}]}return[{data:o==null?void 0:o[0],index:e,offset:0,size:0}]}const Rt={bottom:0,firstItemIndex:0,items:[],offsetBottom:0,offsetTop:0,top:0,topItems:[],topListHeight:0,totalCount:0};function mt(e,t,o,n,r,i){const{lastIndex:l,lastOffset:s,lastSize:c}=r;let a=0,h=0;if(e.length>0){a=e[0].offset;const I=e[e.length-1];h=I.offset+I.size}const w=o-l,m=s+w*c+(w-1)*n,x=a,C=m-h;return{bottom:h,firstItemIndex:i,items:ao(e,r,i),offsetBottom:C,offsetTop:a,top:x,topItems:ao(t,r,i),topListHeight:t.reduce((I,g)=>g.size+I,0),totalCount:o}}function Do(e,t,o,n,r,i){let l=0;if(o.groupIndices.length>0)for(const h of o.groupIndices){if(h-l>=e)break;l++}const s=e+l,c=Vt(t,s),a=Array.from({length:s}).map((h,w)=>({data:i[w+c],index:w+c,offset:0,size:0}));return mt(a,[],s,r,o,n)}function ao(e,t,o){if(e.length===0)return[];if(!St(t))return e.map(a=>({...a,index:a.index+o,originalIndex:a.index}));const n=e[0].index,r=e[e.length-1].index,i=[],l=wt(t.groupOffsetTree,n,r);let s,c=0;for(const a of e){(!s||s.end<a.index)&&(s=l.shift(),c=t.groupIndices.indexOf(s.start));let h;a.index===s.start?h={index:c,type:"group"}:h={groupIndex:c,index:a.index-(c+1)+o},i.push({...h,data:a.data,offset:a.offset,originalIndex:a.index,size:a.size})}return i}const Oe=$(([{data:e,firstItemIndex:t,gap:o,sizes:n,totalCount:r},i,{listBoundary:l,topListHeight:s,visibleRange:c},{initialTopMostItemIndex:a,scrolledToInitialItem:h},{topListHeight:w},m,{didMount:x},{recalcInProgress:C}])=>{const I=S([]),g=S(0),d=_();N(i.topItemsIndexes,I);const u=le(T(oe(x,C,A(c,ot),A(r),A(n),A(a),h,A(I),A(t),A(o),e),P(([f,H,,j,,,,,,,R])=>{const B=R&&R.length!==j;return f&&!H&&!B}),E(([,,[f,H],j,R,B,M,D,F,z,U])=>{const ne=R,{offsetTree:ce,sizeTree:ee}=ne,ve=se(g);if(j===0)return{...Rt,totalCount:j};if(f===0&&H===0)return ve===0?{...Rt,totalCount:j}:Do(ve,B,R,F,z,U||[]);if(K(ee))return ve>0?null:mt(Zn(Vt(B,j),ne,U),[],j,z,ne,F);const fe=[];if(D.length>0){const We=D[0],we=D[D.length-1];let Re=0;for(const y of wt(ee,We,we)){const G=y.value,Z=Math.max(y.start,We),re=Math.min(y.end,we);for(let Q=Z;Q<=re;Q++)fe.push({data:U==null?void 0:U[Q],index:Q,offset:Re,size:G}),Re+=G}}if(!M)return mt([],fe,j,z,ne,F);const ae=D.length>0?D[D.length-1]+1:0,Ne=An(ce,f,H,ae);if(Ne.length===0)return null;const Ie=j-1,Ye=Tt([],We=>{for(const we of Ne){const Re=we.value;let y=Re.offset,G=we.start;const Z=Re.size;if(Re.offset<f){G+=Math.floor((f-Re.offset+z)/(Z+z));const Q=G-we.start;y+=Q*Z+Q*z}G<ae&&(y+=(ae-G)*Z,G=ae);const re=Math.min(we.end,Ie);for(let Q=G;Q<=re&&!(y>=H);Q++)We.push({data:U==null?void 0:U[Q],index:Q,offset:y,size:Z}),y+=Z+z}});return mt(Ye,fe,j,z,ne,F)}),P(f=>f!==null),Y()),Rt);N(T(e,P(Dt),E(f=>f==null?void 0:f.length)),r),N(T(u,E(f=>f.topListHeight)),w),N(w,s),N(T(u,E(f=>[f.top,f.bottom])),l),N(T(u,E(f=>f.items)),d);const b=me(T(u,P(({items:f})=>f.length>0),V(r,e),P(([{items:f},H])=>f[f.length-1].originalIndex===H-1),E(([,f,H])=>[f-1,H]),Y(ot),E(([f])=>f))),k=me(T(u,je(200),P(({items:f,topItems:H})=>f.length>0&&f[0].originalIndex===H.length),E(({items:f})=>f[0].index),Y())),v=me(T(u,P(({items:f})=>f.length>0),E(({items:f})=>{let H=0,j=f.length-1;for(;f[H].type==="group"&&H<j;)H++;for(;f[j].type==="group"&&j>H;)j--;return{endIndex:f[j].index,startIndex:f[H].index}}),Y(zo)));return{endReached:b,initialItemCount:g,itemsRendered:d,listState:u,rangeChanged:v,startReached:k,topItemsIndexes:I,...m}},X(He,Bo,Gt,st,it,lt,Le,At),{singleton:!0}),Fo=$(([{fixedFooterHeight:e,fixedHeaderHeight:t,footerHeight:o,headerHeight:n},{listState:r}])=>{const i=_(),l=le(T(oe(o,e,n,t,r),E(([s,c,a,h,w])=>s+c+a+h+w.offsetBottom+w.bottom)),0);return N(A(l),i),{totalListHeight:l,totalListHeightChanged:i}},X(de,Oe),{singleton:!0}),Jn=$(([{viewportHeight:e},{totalListHeight:t}])=>{const o=S(!1),n=le(T(oe(o,e,t),P(([r])=>r),E(([,r,i])=>Math.max(0,r-i)),je(0),Y()),0);return{alignToBottom:o,paddingTopAddition:n}},X(de,Fo),{singleton:!0});function uo(e){return e?e==="smooth"?"smooth":"auto":!1}const Qn=(e,t)=>typeof e=="function"?uo(e(t)):t&&uo(e),er=$(([{listRefresh:e,totalCount:t},{atBottomState:o,isAtBottom:n},{scrollToIndex:r},{scrolledToInitialItem:i},{didMount:l,propsReady:s},{log:c},{scrollingInProgress:a}])=>{const h=S(!1),w=_();let m=null;function x(I){W(r,{align:"end",behavior:I,index:"LAST"})}q(T(oe(T(A(t),$e(1)),l),V(A(h),n,i,a),E(([[I,g],d,u,b,k])=>{let v=g&&b,f="auto";return v&&(f=Qn(d,u||k),v=v&&!!f),{followOutputBehavior:f,shouldFollow:v,totalCount:I}}),P(({shouldFollow:I})=>I)),({followOutputBehavior:I,totalCount:g})=>{m&&(m(),m=null),m=Ce(e,()=>{se(c)("following output to ",{totalCount:g},pe.DEBUG),x(I),m=null})});function C(I){const g=Ce(o,d=>{I&&!d.atBottom&&d.notAtBottomBecause==="SIZE_INCREASED"&&!m&&(se(c)("scrolling to bottom due to increased size",{},pe.DEBUG),x("auto"))});setTimeout(g,100)}return q(T(oe(A(h),t,s),P(([I,,g])=>I&&g),ye(({value:I},[,g])=>({refreshed:I===g,value:g}),{refreshed:!1,value:0}),P(({refreshed:I})=>I),V(h,t)),([,I])=>{se(i)&&C(I!==!1)}),q(w,()=>{C(se(h)!==!1)}),q(oe(A(h),o),([I,g])=>{I&&!g.atBottom&&g.notAtBottomBecause==="VIEWPORT_HEIGHT_DECREASING"&&x("auto")}),{autoscrollToBottom:w,followOutput:h}},X(He,lt,it,st,Le,Be,de)),tr=$(([{data:e,firstItemIndex:t,gap:o,sizes:n},{initialTopMostItemIndex:r},{initialItemCount:i,listState:l},{didMount:s}])=>(N(T(s,V(i),P(([,c])=>c!==0),V(r,n,t,o,e),E(([[,c],a,h,w,m,x=[]])=>Do(c,a,h,w,m,x))),l),{}),X(He,st,Oe,Le),{singleton:!0}),or=$(([{didMount:e},{scrollTo:t},{listState:o}])=>{const n=S(0);return q(T(e,V(n),P(([,r])=>r!==0),E(([,r])=>({top:r}))),r=>{Ce(T(o,$e(1),P(i=>i.items.length>1)),()=>{requestAnimationFrame(()=>{W(t,r)})})}),{initialScrollTop:n}},X(Le,de,Oe),{singleton:!0}),nr=({itemBottom:e,itemTop:t,locationParams:{align:o,behavior:n,...r},viewportBottom:i,viewportTop:l})=>t<l?{...r,align:o??"start",behavior:n}:e>i?{...r,align:o??"end",behavior:n}:null,rr=$(([{gap:e,sizes:t,totalCount:o},{fixedFooterHeight:n,fixedHeaderHeight:r,headerHeight:i,scrollingInProgress:l,scrollTop:s,viewportHeight:c},{scrollToIndex:a}])=>{const h=_();return N(T(h,V(t,c,o,i,r,n,s),V(e),E(([[w,m,x,C,I,g,d,u],b])=>{const{align:k,behavior:v,calculateViewLocation:f=nr,done:H,...j}=w,R=Mo(w,m,C-1),B=nt(R,m.offsetTree,b)+I+g,M=B+Te(m.sizeTree,R)[1],D=u+g,F=u+x-d,z=f({itemBottom:M,itemTop:B,locationParams:{align:k,behavior:v,...j},viewportBottom:F,viewportTop:D});return z?H&&Ce(T(l,P(U=>!U),$e(se(l)?1:2)),H):H&&H(),z}),P(w=>w!==null)),a),{scrollIntoView:h}},X(He,de,it,Oe,Be),{singleton:!0}),Po=$(([{scrollVelocity:e}])=>{const t=S(!1),o=_(),n=S(!1);return N(T(e,V(n,t,o),P(([r,i])=>!!i),E(([r,i,l,s])=>{const{enter:c,exit:a}=i;if(l){if(a(r,s))return!1}else if(c(r,s))return!0;return l}),Y()),t),q(T(oe(t,e,o),V(n)),([[r,i,l],s])=>{r&&s&&s.change&&s.change(i,l)}),{isSeeking:t,scrollSeekConfiguration:n,scrollSeekRangeChanged:o,scrollVelocity:e}},X(lt),{singleton:!0}),Ut=$(([{scrollContainerState:e,scrollTo:t}])=>{const o=_(),n=_(),r=_(),i=S(!1),l=S(void 0);return N(T(oe(o,n),E(([{scrollHeight:s,scrollTop:c,viewportHeight:a},{offsetTop:h}])=>({scrollHeight:s,scrollTop:Math.max(0,c-h),viewportHeight:a}))),e),N(T(t,V(n),E(([s,{offsetTop:c}])=>({...s,top:s.top+c}))),r),{customScrollParent:l,useWindowScroll:i,windowScrollContainerState:o,windowScrollTo:r,windowViewportRect:n}},X(de)),ir=$(([{sizeRanges:e,sizes:t},{headerHeight:o,scrollTop:n},{initialTopMostItemIndex:r},{didMount:i},{useWindowScroll:l,windowScrollContainerState:s,windowViewportRect:c}])=>{const a=_(),h=S(void 0),w=S(null),m=S(null);return N(s,w),N(c,m),q(T(a,V(t,n,l,w,m,o)),([x,C,I,g,d,u,b])=>{const k=Wn(C.sizeTree);g&&d!==null&&u!==null&&(I=d.scrollTop-u.offsetTop),I-=b,x({ranges:k,scrollTop:I})}),N(T(h,P(Dt),E(sr)),r),N(T(i,V(h),P(([,x])=>x!==void 0),Y(),E(([,x])=>x.ranges)),e),{getState:a,restoreStateFrom:h}},X(He,de,st,Le,Ut));function sr(e){return{align:"start",index:0,offset:e.scrollTop}}const lr=$(([{topItemsIndexes:e}])=>{const t=S(0);return N(T(t,P(o=>o>=0),E(o=>Array.from({length:o}).map((n,r)=>r))),e),{topItemCount:t}},X(Oe));function Ao(e){let t=!1,o;return()=>(t||(t=!0,o=e()),o)}const cr=Ao(()=>/iP(ad|od|hone)/i.test(navigator.userAgent)&&/WebKit/i.test(navigator.userAgent)),ar=$(([{deviation:e,scrollBy:t,scrollingInProgress:o,scrollTop:n},{isAtBottom:r,isScrolling:i,lastJumpDueToItemResize:l,scrollDirection:s},{listState:c},{beforeUnshiftWith:a,gap:h,shiftWithOffset:w,sizes:m},{log:x},{recalcInProgress:C}])=>{const I=me(T(c,V(l),ye(([,d,u,b],[{bottom:k,items:v,offsetBottom:f,totalCount:H},j])=>{const R=k+f;let B=0;return u===H&&d.length>0&&v.length>0&&(v[0].originalIndex===0&&d[0].originalIndex===0||(B=R-b,B!==0&&(B+=j))),[B,v,H,R]},[0,[],0,0]),P(([d])=>d!==0),V(n,s,o,r,x,C),P(([,d,u,b,,,k])=>!k&&!b&&d!==0&&u===rt),E(([[d],,,,,u])=>(u("Upward scrolling compensation",{amount:d},pe.DEBUG),d))));function g(d){d>0?(W(t,{behavior:"auto",top:-d}),W(e,0)):(W(e,0),W(t,{behavior:"auto",top:-d}))}return q(T(I,V(e,i)),([d,u,b])=>{b&&cr()?W(e,u-d):g(-d)}),q(T(oe(le(i,!1),e,C),P(([d,u,b])=>!d&&!b&&u!==0),E(([d,u])=>u),je(1)),g),N(T(w,E(d=>({top:-d}))),t),q(T(a,V(m,h),E(([d,{groupIndices:u,lastSize:b,sizeTree:k},v])=>{function f(H){return H*(b+v)}if(u.length===0)return f(d);{let H=0;const j=tt(k,0);let R=0,B=0;for(;R<d;){R++,H+=j;let M=u.length===B+1?1/0:u[B+1]-u[B]-1;R+M>d&&(H-=j,M=d-R+1),R+=M,H+=f(M),B++}return H}})),d=>{W(e,d),requestAnimationFrame(()=>{W(t,{top:d}),requestAnimationFrame(()=>{W(e,0),W(C,!1)})})}),{deviation:e}},X(de,lt,Oe,He,Be,At)),ur=$(([e,t,o,n,r,i,l,s,c,a])=>({...e,...t,...o,...n,...r,...i,...l,...s,...c,...a}),X(Gt,tr,Le,Po,Fo,or,Jn,Ut,rr,Be)),Oo=$(([{data:e,defaultItemSize:t,firstItemIndex:o,fixedItemSize:n,gap:r,groupIndices:i,itemSize:l,sizeRanges:s,sizes:c,statefulTotalCount:a,totalCount:h,trackItemSizes:w},{initialItemFinalLocationReached:m,initialTopMostItemIndex:x,scrolledToInitialItem:C},I,g,d,{listState:u,topItemsIndexes:b,...k},{scrollToIndex:v},f,{topItemCount:H},{groupCounts:j},R])=>(N(k.rangeChanged,R.scrollSeekRangeChanged),N(T(R.windowViewportRect,E(B=>B.visibleHeight)),I.viewportHeight),{data:e,defaultItemHeight:t,firstItemIndex:o,fixedItemHeight:n,gap:r,groupCounts:j,initialItemFinalLocationReached:m,initialTopMostItemIndex:x,scrolledToInitialItem:C,sizeRanges:s,topItemCount:H,topItemsIndexes:b,totalCount:h,...d,groupIndices:i,itemSize:l,listState:u,scrollToIndex:v,statefulTotalCount:a,trackItemSizes:w,...k,...R,...I,sizes:c,...g}),X(He,st,de,ir,er,Oe,it,ar,lr,Bo,ur));function dr(e,t){const o={},n={};let r=0;const i=e.length;for(;r<i;)n[e[r]]=1,r+=1;for(const l in t)Object.hasOwn(n,l)||(o[l]=t[l]);return o}const dt=typeof document<"u"?L.useLayoutEffect:L.useEffect;function Wo(e,t,o){const n=Object.keys(t.required||{}),r=Object.keys(t.optional||{}),i=Object.keys(t.methods||{}),l=Object.keys(t.events||{}),s=L.createContext({});function c(g,d){g.propsReady&&W(g.propsReady,!1);for(const u of n){const b=g[t.required[u]];W(b,d[u])}for(const u of r)if(u in d){const b=g[t.optional[u]];W(b,d[u])}g.propsReady&&W(g.propsReady,!0)}function a(g){return i.reduce((d,u)=>(d[u]=b=>{const k=g[t.methods[u]];W(k,b)},d),{})}function h(g){return l.reduce((d,u)=>(d[u]=Hn(g[t.events[u]]),d),{})}const w=L.forwardRef((g,d)=>{const{children:u,...b}=g,[k]=L.useState(()=>Tt(kn(e),H=>{c(H,b)})),[v]=L.useState(eo(h,k));dt(()=>{for(const H of l)H in b&&q(v[H],b[H]);return()=>{Object.values(v).map(Ft)}},[b,v,k]),dt(()=>{c(k,b)}),L.useImperativeHandle(d,Qt(a(k)));const f=o;return p.jsx(s.Provider,{value:k,children:o?p.jsx(f,{...dr([...n,...r,...l],b),children:u}):u})}),m=g=>{const d=L.useContext(s);return L.useCallback(u=>{W(d[g],u)},[d,g])},x=g=>{const d=L.useContext(s)[g],u=L.useCallback(b=>q(d,b),[d]);return L.useSyncExternalStore(u,()=>se(d),()=>se(d))},C=g=>{const d=L.useContext(s)[g],[u,b]=L.useState(eo(se,d));return dt(()=>q(d,k=>{k!==u&&b(Qt(k))}),[d,u]),u},I=L.version.startsWith("18")?x:C;return{Component:w,useEmitter:(g,d)=>{const u=L.useContext(s)[g];dt(()=>q(u,d),[d,u])},useEmitterValue:I,usePublisher:m}}const Vo=L.createContext(void 0),Go=L.createContext(void 0),Uo=typeof document<"u"?L.useLayoutEffect:L.useEffect;function kt(e){return"self"in e}function fr(e){return"body"in e}function _o(e,t,o,n=Ke,r,i){const l=L.useRef(null),s=L.useRef(null),c=L.useRef(null),a=L.useCallback(m=>{let x,C,I;const g=m.target;if(fr(g)||kt(g)){const u=kt(g)?g:g.defaultView;I=i?u.scrollX:u.scrollY,x=i?u.document.documentElement.scrollWidth:u.document.documentElement.scrollHeight,C=i?u.innerWidth:u.innerHeight}else I=i?g.scrollLeft:g.scrollTop,x=i?g.scrollWidth:g.scrollHeight,C=i?g.offsetWidth:g.offsetHeight;const d=()=>{e({scrollHeight:x,scrollTop:Math.max(I,0),viewportHeight:C})};m.suppressFlushSync?d():en.flushSync(d),s.current!==null&&(I===s.current||I<=0||I===x-C)&&(s.current=null,t(!0),c.current&&(clearTimeout(c.current),c.current=null))},[e,t,i]);L.useEffect(()=>{const m=r||l.current;return n(r||l.current),a({suppressFlushSync:!0,target:m}),m.addEventListener("scroll",a,{passive:!0}),()=>{n(null),m.removeEventListener("scroll",a)}},[l,a,o,n,r]);function h(m){const x=l.current;if(!x||(i?"offsetWidth"in x&&x.offsetWidth===0:"offsetHeight"in x&&x.offsetHeight===0))return;const C=m.behavior==="smooth";let I,g,d;kt(x)?(g=Math.max(Ee(x.document.documentElement,i?"width":"height"),i?x.document.documentElement.scrollWidth:x.document.documentElement.scrollHeight),I=i?x.innerWidth:x.innerHeight,d=i?window.scrollX:window.scrollY):(g=x[i?"scrollWidth":"scrollHeight"],I=Ee(x,i?"width":"height"),d=x[i?"scrollLeft":"scrollTop"]);const u=g-I;if(m.top=Math.ceil(Math.max(Math.min(u,m.top),0)),No(I,g)||m.top===d){e({scrollHeight:g,scrollTop:d,viewportHeight:I}),C&&t(!0);return}C?(s.current=m.top,c.current&&clearTimeout(c.current),c.current=setTimeout(()=>{c.current=null,s.current=null,t(!0)},1e3)):s.current=null,i&&(m={behavior:m.behavior,left:m.top}),x.scrollTo(m)}function w(m){i&&(m={behavior:m.behavior,left:m.top}),l.current.scrollBy(m)}return{scrollByCallback:w,scrollerRef:l,scrollToCallback:h}}const zt="-webkit-sticky",fo="sticky",$o=Ao(()=>{if(typeof document>"u")return fo;const e=document.createElement("div");return e.style.position=zt,e.style.position===zt?zt:fo});function _t(e){return e}const hr=$(()=>{const e=S(c=>`Item ${c}`),t=S(null),o=S(c=>`Group ${c}`),n=S({}),r=S(_t),i=S("div"),l=S(Ke),s=(c,a=null)=>le(T(n,E(h=>h[c]),Y()),a);return{components:n,computeItemKey:r,context:t,EmptyPlaceholder:s("EmptyPlaceholder"),FooterComponent:s("Footer"),GroupComponent:s("Group","div"),groupContent:o,HeaderComponent:s("Header"),HeaderFooterTag:i,ItemComponent:s("Item","div"),itemContent:e,ListComponent:s("List","div"),ScrollerComponent:s("Scroller","div"),scrollerRef:l,ScrollSeekPlaceholder:s("ScrollSeekPlaceholder"),TopItemListComponent:s("TopItemList")}}),mr=$(([e,t])=>({...e,...t}),X(Oo,hr)),pr=({height:e})=>p.jsx("div",{style:{height:e}}),gr={overflowAnchor:"none",position:$o(),zIndex:1},qo={overflowAnchor:"none"},xr={...qo,display:"inline-block",height:"100%"},ho=L.memo(function({showTopList:e=!1}){const t=O("listState"),o=ge("sizeRanges"),n=O("useWindowScroll"),r=O("customScrollParent"),i=ge("windowScrollContainerState"),l=ge("scrollContainerState"),s=r||n?i:l,c=O("itemContent"),a=O("context"),h=O("groupContent"),w=O("trackItemSizes"),m=O("itemSize"),x=O("log"),C=ge("gap"),I=O("horizontalDirection"),{callbackRef:g}=En(o,m,w,e?Ke:s,x,C,r,I,O("skipAnimationFrameInResizeObserver")),[d,u]=L.useState(0);$t("deviation",z=>{d!==z&&u(z)});const b=O("EmptyPlaceholder"),k=O("ScrollSeekPlaceholder")||pr,v=O("ListComponent"),f=O("ItemComponent"),H=O("GroupComponent"),j=O("computeItemKey"),R=O("isSeeking"),B=O("groupIndices").length>0,M=O("alignToBottom"),D=O("initialItemFinalLocationReached"),F=e?{}:{boxSizing:"border-box",...I?{display:"inline-block",height:"100%",marginLeft:d!==0?d:M?"auto":0,paddingLeft:t.offsetTop,paddingRight:t.offsetBottom,whiteSpace:"nowrap"}:{marginTop:d!==0?d:M?"auto":0,paddingBottom:t.offsetBottom,paddingTop:t.offsetTop},...D?{}:{visibility:"hidden"}};return!e&&t.totalCount===0&&b?p.jsx(b,{...ie(b,a)}):p.jsx(v,{...ie(v,a),"data-testid":e?"virtuoso-top-item-list":"virtuoso-item-list",ref:g,style:F,children:(e?t.topItems:t.items).map(z=>{const U=z.originalIndex,ne=j(U+t.firstItemIndex,z.data,a);return R?ue.createElement(k,{...ie(k,a),height:z.size,index:z.index,key:ne,type:z.type||"item",...z.type==="group"?{}:{groupIndex:z.groupIndex}}):z.type==="group"?ue.createElement(H,{...ie(H,a),"data-index":U,"data-item-index":z.index,"data-known-size":z.size,key:ne,style:gr},h(z.index,a)):ue.createElement(f,{...ie(f,a),...wr(f,z.data),"data-index":U,"data-item-group-index":z.groupIndex,"data-item-index":z.index,"data-known-size":z.size,key:ne,style:I?xr:qo},B?c(z.index,z.groupIndex,z.data,a):c(z.index,z.data,a))})})}),vr={height:"100%",outline:"none",overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},Ir={outline:"none",overflowX:"auto",position:"relative"},bt=e=>({height:"100%",position:"absolute",top:0,width:"100%",...e?{display:"flex",flexDirection:"column"}:{}}),Tr={position:$o(),top:0,width:"100%",zIndex:1};function ie(e,t){if(typeof e!="string")return{context:t}}function wr(e,t){return{item:typeof e=="string"?void 0:t}}const Sr=L.memo(function(){const e=O("HeaderComponent"),t=ge("headerHeight"),o=O("HeaderFooterTag"),n=Ae(L.useMemo(()=>i=>{t(Ee(i,"height"))},[t]),!0,O("skipAnimationFrameInResizeObserver")),r=O("context");return e?p.jsx(o,{ref:n,children:p.jsx(e,{...ie(e,r)})}):null}),br=L.memo(function(){const e=O("FooterComponent"),t=ge("footerHeight"),o=O("HeaderFooterTag"),n=Ae(L.useMemo(()=>i=>{t(Ee(i,"height"))},[t]),!0,O("skipAnimationFrameInResizeObserver")),r=O("context");return e?p.jsx(o,{ref:n,children:p.jsx(e,{...ie(e,r)})}):null});function Ko({useEmitter:e,useEmitterValue:t,usePublisher:o}){return L.memo(function({children:n,style:r,...i}){const l=o("scrollContainerState"),s=t("ScrollerComponent"),c=o("smoothScrollTargetReached"),a=t("scrollerRef"),h=t("context"),w=t("horizontalDirection")||!1,{scrollByCallback:m,scrollerRef:x,scrollToCallback:C}=_o(l,c,s,a,void 0,w);return e("scrollTo",C),e("scrollBy",m),p.jsx(s,{"data-testid":"virtuoso-scroller","data-virtuoso-scroller":!0,ref:x,style:{...w?Ir:vr,...r},tabIndex:0,...i,...ie(s,h),children:n})})}function Yo({useEmitter:e,useEmitterValue:t,usePublisher:o}){return L.memo(function({children:n,style:r,...i}){const l=o("windowScrollContainerState"),s=t("ScrollerComponent"),c=o("smoothScrollTargetReached"),a=t("totalListHeight"),h=t("deviation"),w=t("customScrollParent"),m=t("context"),x=L.useRef(null),C=t("scrollerRef"),{scrollByCallback:I,scrollerRef:g,scrollToCallback:d}=_o(l,c,s,C,w);return Uo(()=>{var u;return g.current=w||((u=x.current)==null?void 0:u.ownerDocument.defaultView),()=>{g.current=null}},[g,w]),e("windowScrollTo",d),e("scrollBy",I),p.jsx(s,{ref:x,"data-virtuoso-scroller":!0,style:{position:"relative",...r,...a!==0?{height:a+h}:{}},...i,...ie(s,m),children:n})})}const yr=({children:e})=>{const t=L.useContext(Vo),o=ge("viewportHeight"),n=ge("fixedItemHeight"),r=O("alignToBottom"),i=O("horizontalDirection"),l=L.useMemo(()=>wo(o,c=>Ee(c,i?"width":"height")),[o,i]),s=Ae(l,!0,O("skipAnimationFrameInResizeObserver"));return L.useEffect(()=>{t&&(o(t.viewportHeight),n(t.itemHeight))},[t,o,n]),p.jsx("div",{"data-viewport-type":"element",ref:s,style:bt(r),children:e})},Cr=({children:e})=>{const t=L.useContext(Vo),o=ge("windowViewportRect"),n=ge("fixedItemHeight"),r=O("customScrollParent"),i=bo(o,r,O("skipAnimationFrameInResizeObserver")),l=O("alignToBottom");return L.useEffect(()=>{t&&(n(t.itemHeight),o({offsetTop:0,visibleHeight:t.viewportHeight,visibleWidth:100}))},[t,o,n]),p.jsx("div",{"data-viewport-type":"window",ref:i,style:bt(l),children:e})},Hr=({children:e})=>{const t=O("TopItemListComponent")||"div",o=O("headerHeight"),n={...Tr,marginTop:`${o}px`},r=O("context");return p.jsx(t,{style:n,...ie(t,r),children:e})},Rr=L.memo(function(e){const t=O("useWindowScroll"),o=O("topItemsIndexes").length>0,n=O("customScrollParent"),r=O("context"),i=n||t?jr:zr,l=n||t?Cr:yr;return p.jsxs(i,{...e,...ie(i,r),children:[o&&p.jsx(Hr,{children:p.jsx(ho,{showTopList:!0})}),p.jsxs(l,{children:[p.jsx(Sr,{}),p.jsx(ho,{}),p.jsx(br,{})]})]})}),{Component:kr,useEmitter:$t,useEmitterValue:O,usePublisher:ge}=Wo(mr,{required:{},optional:{restoreStateFrom:"restoreStateFrom",context:"context",followOutput:"followOutput",itemContent:"itemContent",groupContent:"groupContent",overscan:"overscan",increaseViewportBy:"increaseViewportBy",totalCount:"totalCount",groupCounts:"groupCounts",topItemCount:"topItemCount",firstItemIndex:"firstItemIndex",initialTopMostItemIndex:"initialTopMostItemIndex",components:"components",atBottomThreshold:"atBottomThreshold",atTopThreshold:"atTopThreshold",computeItemKey:"computeItemKey",defaultItemHeight:"defaultItemHeight",fixedItemHeight:"fixedItemHeight",itemSize:"itemSize",scrollSeekConfiguration:"scrollSeekConfiguration",headerFooterTag:"HeaderFooterTag",data:"data",initialItemCount:"initialItemCount",initialScrollTop:"initialScrollTop",alignToBottom:"alignToBottom",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",logLevel:"logLevel",horizontalDirection:"horizontalDirection",skipAnimationFrameInResizeObserver:"skipAnimationFrameInResizeObserver"},methods:{scrollToIndex:"scrollToIndex",scrollIntoView:"scrollIntoView",scrollTo:"scrollTo",scrollBy:"scrollBy",autoscrollToBottom:"autoscrollToBottom",getState:"getState"},events:{isScrolling:"isScrolling",endReached:"endReached",startReached:"startReached",rangeChanged:"rangeChanged",atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange",totalListHeightChanged:"totalListHeightChanged",itemsRendered:"itemsRendered",groupIndices:"groupIndices"}},Rr),zr=Ko({useEmitter:$t,useEmitterValue:O,usePublisher:ge}),jr=Yo({useEmitter:$t,useEmitterValue:O,usePublisher:ge}),Er=kr,Mr=$(()=>{const e=S(c=>p.jsxs("td",{children:["Item $",c]})),t=S(null),o=S(null),n=S(null),r=S({}),i=S(_t),l=S(Ke),s=(c,a=null)=>le(T(r,E(h=>h[c]),Y()),a);return{components:r,computeItemKey:i,context:t,EmptyPlaceholder:s("EmptyPlaceholder"),FillerRow:s("FillerRow"),fixedFooterContent:n,fixedHeaderContent:o,itemContent:e,ScrollerComponent:s("Scroller","div"),scrollerRef:l,ScrollSeekPlaceholder:s("ScrollSeekPlaceholder"),TableBodyComponent:s("TableBody","tbody"),TableComponent:s("Table","table"),TableFooterComponent:s("TableFoot","tfoot"),TableHeadComponent:s("TableHead","thead"),TableRowComponent:s("TableRow","tr")}});X(Oo,Mr);const mo={bottom:0,itemHeight:0,items:[],itemWidth:0,offsetBottom:0,offsetTop:0,top:0},Br={bottom:0,itemHeight:0,items:[{index:0}],itemWidth:0,offsetBottom:0,offsetTop:0,top:0},{ceil:po,floor:vt,max:Qe,min:jt,round:go}=Math;function xo(e,t,o){return Array.from({length:t-e+1}).map((n,r)=>({data:o===null?null:o[r+e],index:r+e}))}function Lr(e){return{...Br,items:e}}function ft(e,t){return e&&e.width===t.width&&e.height===t.height}function Nr(e,t){return e&&e.column===t.column&&e.row===t.row}const Dr=$(([{increaseViewportBy:e,listBoundary:t,overscan:o,visibleRange:n},{footerHeight:r,headerHeight:i,scrollBy:l,scrollContainerState:s,scrollTo:c,scrollTop:a,smoothScrollTargetReached:h,viewportHeight:w},m,x,{didMount:C,propsReady:I},{customScrollParent:g,useWindowScroll:d,windowScrollContainerState:u,windowScrollTo:b,windowViewportRect:k},v])=>{const f=S(0),H=S(0),j=S(mo),R=S({height:0,width:0}),B=S({height:0,width:0}),M=_(),D=_(),F=S(0),z=S(null),U=S({column:0,row:0}),ne=_(),ce=_(),ee=S(!1),ve=S(0),fe=S(!0),ae=S(!1),Ne=S(!1);q(T(C,V(ve),P(([y,G])=>!!G)),()=>{W(fe,!1)}),q(T(oe(C,fe,B,R,ve,ae),P(([y,G,Z,re,,Q])=>y&&!G&&Z.height!==0&&re.height!==0&&!Q)),([,,,,y])=>{W(ae,!0),Wt(1,()=>{W(M,y)}),Ce(T(a),()=>{W(t,[0,0]),W(fe,!0)})}),N(T(ce,P(y=>y!=null&&y.scrollTop>0),be(0)),H),q(T(C,V(ce),P(([,y])=>y!=null)),([,y])=>{y&&(W(R,y.viewport),W(B,y.item),W(U,y.gap),y.scrollTop>0&&(W(ee,!0),Ce(T(a,$e(1)),G=>{W(ee,!1)}),W(c,{top:y.scrollTop})))}),N(T(R,E(({height:y})=>y)),w),N(T(oe(A(R,ft),A(B,ft),A(U,(y,G)=>y&&y.column===G.column&&y.row===G.row),A(a)),E(([y,G,Z,re])=>({gap:Z,item:G,scrollTop:re,viewport:y}))),ne),N(T(oe(A(f),n,A(U,Nr),A(B,ft),A(R,ft),A(z),A(H),A(ee),A(fe),A(ve)),P(([,,,,,,,y])=>!y),E(([y,[G,Z],re,Q,De,Xe,Ve,,ct,ke])=>{const{column:ze,row:Ze}=re,{height:at,width:yt}=Q,{width:qt}=De;if(Ve===0&&(y===0||qt===0))return mo;if(yt===0){const Jt=Vt(ke,y),Qo=Jt+Math.max(Ve-1,0);return Lr(xo(Jt,Qo,Xe))}const ut=Xo(qt,yt,ze);let Ge,Fe;ct?G===0&&Z===0&&Ve>0?(Ge=0,Fe=Ve-1):(Ge=ut*vt((G+Ze)/(at+Ze)),Fe=ut*po((Z+Ze)/(at+Ze))-1,Fe=jt(y-1,Qe(Fe,ut-1)),Ge=jt(Fe,Qe(0,Ge))):(Ge=0,Fe=-1);const Kt=xo(Ge,Fe,Xe),{bottom:Yt,top:Xt}=vo(De,re,Q,Kt),Zt=po(y/ut),Jo=Zt*at+(Zt-1)*Ze-Yt;return{bottom:Yt,itemHeight:at,items:Kt,itemWidth:yt,offsetBottom:Jo,offsetTop:Xt,top:Xt}})),j),N(T(z,P(y=>y!==null),E(y=>y.length)),f),N(T(oe(R,B,j,U),P(([y,G,{items:Z}])=>Z.length>0&&G.height!==0&&y.height!==0),E(([y,G,{items:Z},re])=>{const{bottom:Q,top:De}=vo(y,re,G,Z);return[De,Q]}),Y(ot)),t);const Ie=S(!1);N(T(a,V(Ie),E(([y,G])=>G||y!==0)),Ie);const Ye=me(T(oe(j,f),P(([{items:y}])=>y.length>0),V(Ie),P(([[y,G],Z])=>{const re=y.items[y.items.length-1].index===G-1;return(Z||y.bottom>0&&y.itemHeight>0&&y.offsetBottom===0&&y.items.length===G)&&re}),E(([[,y]])=>y-1),Y())),We=me(T(A(j),P(({items:y})=>y.length>0&&y[0].index===0),be(0),Y())),we=me(T(A(j),V(ee),P(([{items:y},G])=>y.length>0&&!G),E(([{items:y}])=>({endIndex:y[y.length-1].index,startIndex:y[0].index})),Y(zo),je(0)));N(we,x.scrollSeekRangeChanged),N(T(M,V(R,B,f,U),E(([y,G,Z,re,Q])=>{const De=Lo(y),{align:Xe,behavior:Ve,offset:ct}=De;let ke=De.index;ke==="LAST"&&(ke=re-1),ke=Qe(0,ke,jt(re-1,ke));let ze=Nt(G,Q,Z,ke);return Xe==="end"?ze=go(ze-G.height+Z.height):Xe==="center"&&(ze=go(ze-G.height/2+Z.height/2)),ct&&(ze+=ct),{behavior:Ve,top:ze}})),c);const Re=le(T(j,E(y=>y.offsetBottom+y.bottom)),0);return N(T(k,E(y=>({height:y.visibleHeight,width:y.visibleWidth}))),R),{customScrollParent:g,data:z,deviation:F,footerHeight:r,gap:U,headerHeight:i,increaseViewportBy:e,initialItemCount:H,itemDimensions:B,overscan:o,restoreStateFrom:ce,scrollBy:l,scrollContainerState:s,scrollHeight:D,scrollTo:c,scrollToIndex:M,scrollTop:a,smoothScrollTargetReached:h,totalCount:f,useWindowScroll:d,viewportDimensions:R,windowScrollContainerState:u,windowScrollTo:b,windowViewportRect:k,...x,gridState:j,horizontalDirection:Ne,initialTopMostItemIndex:ve,totalListHeight:Re,...m,endReached:Ye,propsReady:I,rangeChanged:we,startReached:We,stateChanged:ne,stateRestoreInProgress:ee,...v}},X(Gt,de,lt,Po,Le,Ut,Be));function Xo(e,t,o){return Qe(1,vt((e+o)/(vt(t)+o)))}function vo(e,t,o,n){const{height:r}=o;if(r===void 0||n.length===0)return{bottom:0,top:0};const i=Nt(e,t,o,n[0].index);return{bottom:Nt(e,t,o,n[n.length-1].index)+r,top:i}}function Nt(e,t,o,n){const r=Xo(e.width,o.width,t.column),i=vt(n/r),l=i*o.height+Qe(0,i-1)*t.row;return l>0?l+t.row:l}const Fr=$(()=>{const e=S(w=>`Item ${w}`),t=S({}),o=S(null),n=S("virtuoso-grid-item"),r=S("virtuoso-grid-list"),i=S(_t),l=S("div"),s=S(Ke),c=(w,m=null)=>le(T(t,E(x=>x[w]),Y()),m),a=S(!1),h=S(!1);return N(A(h),a),{components:t,computeItemKey:i,context:o,FooterComponent:c("Footer"),HeaderComponent:c("Header"),headerFooterTag:l,itemClassName:n,ItemComponent:c("Item","div"),itemContent:e,listClassName:r,ListComponent:c("List","div"),readyStateChanged:a,reportReadyState:h,ScrollerComponent:c("Scroller","div"),scrollerRef:s,ScrollSeekPlaceholder:c("ScrollSeekPlaceholder","div")}}),Pr=$(([e,t])=>({...e,...t}),X(Dr,Fr)),Ar=L.memo(function(){const e=J("gridState"),t=J("listClassName"),o=J("itemClassName"),n=J("itemContent"),r=J("computeItemKey"),i=J("isSeeking"),l=xe("scrollHeight"),s=J("ItemComponent"),c=J("ListComponent"),a=J("ScrollSeekPlaceholder"),h=J("context"),w=xe("itemDimensions"),m=xe("gap"),x=J("log"),C=J("stateRestoreInProgress"),I=xe("reportReadyState"),g=Ae(L.useMemo(()=>d=>{const u=d.parentElement.parentElement.scrollHeight;l(u);const b=d.firstChild;if(b){const{height:k,width:v}=b.getBoundingClientRect();w({height:k,width:v})}m({column:Io("column-gap",getComputedStyle(d).columnGap,x),row:Io("row-gap",getComputedStyle(d).rowGap,x)})},[l,w,m,x]),!0,!1);return Uo(()=>{e.itemHeight>0&&e.itemWidth>0&&I(!0)},[e]),C?null:p.jsx(c,{className:t,ref:g,...ie(c,h),"data-testid":"virtuoso-item-list",style:{paddingBottom:e.offsetBottom,paddingTop:e.offsetTop},children:e.items.map(d=>{const u=r(d.index,d.data,h);return i?p.jsx(a,{...ie(a,h),height:e.itemHeight,index:d.index,width:e.itemWidth},u):ue.createElement(s,{...ie(s,h),className:o,"data-index":d.index,key:u},n(d.index,d.data,h))})})}),Or=L.memo(function(){const e=J("HeaderComponent"),t=xe("headerHeight"),o=J("headerFooterTag"),n=Ae(L.useMemo(()=>i=>{t(Ee(i,"height"))},[t]),!0,!1),r=J("context");return e?p.jsx(o,{ref:n,children:p.jsx(e,{...ie(e,r)})}):null}),Wr=L.memo(function(){const e=J("FooterComponent"),t=xe("footerHeight"),o=J("headerFooterTag"),n=Ae(L.useMemo(()=>i=>{t(Ee(i,"height"))},[t]),!0,!1),r=J("context");return e?p.jsx(o,{ref:n,children:p.jsx(e,{...ie(e,r)})}):null}),Vr=({children:e})=>{const t=L.useContext(Go),o=xe("itemDimensions"),n=xe("viewportDimensions"),r=Ae(L.useMemo(()=>i=>{n(i.getBoundingClientRect())},[n]),!0,!1);return L.useEffect(()=>{t&&(n({height:t.viewportHeight,width:t.viewportWidth}),o({height:t.itemHeight,width:t.itemWidth}))},[t,n,o]),p.jsx("div",{ref:r,style:bt(!1),children:e})},Gr=({children:e})=>{const t=L.useContext(Go),o=xe("windowViewportRect"),n=xe("itemDimensions"),r=J("customScrollParent"),i=bo(o,r,!1);return L.useEffect(()=>{t&&(n({height:t.itemHeight,width:t.itemWidth}),o({offsetTop:0,visibleHeight:t.viewportHeight,visibleWidth:t.viewportWidth}))},[t,o,n]),p.jsx("div",{ref:i,style:bt(!1),children:e})},Ur=L.memo(function({...e}){const t=J("useWindowScroll"),o=J("customScrollParent"),n=o||t?$r:_r,r=o||t?Gr:Vr,i=J("context");return p.jsx(n,{...e,...ie(n,i),children:p.jsxs(r,{children:[p.jsx(Or,{}),p.jsx(Ar,{}),p.jsx(Wr,{})]})})}),{useEmitter:Zo,useEmitterValue:J,usePublisher:xe}=Wo(Pr,{optional:{context:"context",totalCount:"totalCount",overscan:"overscan",itemContent:"itemContent",components:"components",computeItemKey:"computeItemKey",data:"data",initialItemCount:"initialItemCount",scrollSeekConfiguration:"scrollSeekConfiguration",headerFooterTag:"headerFooterTag",listClassName:"listClassName",itemClassName:"itemClassName",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",logLevel:"logLevel",restoreStateFrom:"restoreStateFrom",initialTopMostItemIndex:"initialTopMostItemIndex",increaseViewportBy:"increaseViewportBy"},methods:{scrollTo:"scrollTo",scrollBy:"scrollBy",scrollToIndex:"scrollToIndex"},events:{isScrolling:"isScrolling",endReached:"endReached",startReached:"startReached",rangeChanged:"rangeChanged",atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange",stateChanged:"stateChanged",readyStateChanged:"readyStateChanged"}},Ur),_r=Ko({useEmitter:Zo,useEmitterValue:J,usePublisher:xe}),$r=Yo({useEmitter:Zo,useEmitterValue:J,usePublisher:xe});function Io(e,t,o){return t!=="normal"&&!(t!=null&&t.endsWith("px"))&&o(`${e} was not resolved to pixel value correctly`,t,pe.WARN),t==="normal"?0:parseInt(t??"0",10)}const qr=({size:e="md",className:t,variant:o="default"})=>{const n={sm:"h-4 w-4",md:"h-6 w-6",lg:"h-10 w-10"},r={default:"text-gray-400",primary:"text-cybergold-500",secondary:"text-blue-500"};return p.jsx(pn,{className:Se("animate-spin",n[e],r[o],t)})},oi=({messages:e,variant:t,userId:o="",isLoading:n=!1,hasMore:r=!1,showDateSeparators:i=!0,groupMessages:l=!0,avatarMapping:s={},nameMapping:c={},onLoadMore:a,onReply:h,onEdit:w,onDelete:m,onReactionSelect:x,className:C})=>{const I=ue.useRef(null),[g,d]=ue.useState([]),[u,b]=ue.useState(!1);ue.useEffect(()=>{if(!e.length){d([]);return}if(!l){const M=e.reduce((D,F)=>{const z=new Date(F.timestamp),U=Ct(z,"yyyy-MM-dd");return D[U]||(D[U]={date:new Date(z.setHours(0,0,0,0)),messages:[]}),D[U].messages.push(F),D},{});d(Object.values(M).sort((D,F)=>D.date.getTime()-F.date.getTime()));return}const B=[...e].sort((M,D)=>new Date(M.timestamp).getTime()-new Date(D.timestamp).getTime()).reduce((M,D)=>{const F=new Date(D.timestamp),z=Ct(F,"yyyy-MM-dd");return M[z]||(M[z]={date:new Date(F.setHours(0,0,0,0)),messages:[]}),M[z].messages.push(D),M},{});d(Object.values(B).sort((M,D)=>M.date.getTime()-D.date.getTime()))},[e,l]),ue.useEffect(()=>{e.length&&!u&&I.current&&(I.current.scrollToIndex({index:e.length-1,behavior:"auto"}),b(!0))},[e.length,u]);const k=(R,B)=>{if(!l)return!0;const M=g[B],D=M.messages[R],F=R<M.messages.length-1?M.messages[R+1]:null;return F?D.senderId!==F.senderId:!0},v=(R,B)=>{const M=R.senderId===o;return p.jsx(Tn,{message:R,isOwn:M,variant:t,isRead:R.isRead,showAvatar:B,senderName:c[R.senderId]||R.senderName,senderAvatarUrl:s[R.senderId],isEncrypted:R.isEncrypted,ephemeral:R.ephemeral,expiresAt:R.expiresAt?new Date(R.expiresAt):null,onEdit:M?w:void 0,onDelete:M?m:void 0,onReply:h,onReactionSelect:x},R.id)},f=R=>p.jsx("div",{className:"flex items-center justify-center my-2 sticky top-0 z-10",children:p.jsx("div",{className:"bg-cyberdark-950/80 px-4 py-1 rounded-full text-xs text-cybergold-500 backdrop-blur-sm",children:Ct(R,"EEEE, d. MMMM yyyy")})}),H=()=>n?p.jsx("div",{className:"flex justify-center my-4",children:p.jsx(qr,{className:"h-6 w-6 text-cybergold-500"})}):null,j=()=>{r&&a&&a()};return!e.length&&!n?p.jsx("div",{className:Se("flex flex-col flex-1 items-center justify-center p-8",C),children:p.jsx("div",{className:"text-cyberdark-400 text-sm",children:"Ingen meldinger ennÃ¥"})}):p.jsxs("div",{className:Se("flex-1 flex flex-col h-full",C),children:[H(),p.jsx(Er,{ref:I,className:"flex-1",data:g,startReached:j,itemContent:(R,B)=>p.jsxs(p.Fragment,{children:[i&&f(B.date),B.messages.map((M,D)=>p.jsx("div",{children:v(M,k(D,R))},M.id))]})})]})};export{oi as default};
