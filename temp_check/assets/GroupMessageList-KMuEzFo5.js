import{j as e}from"./vendor-ui-DJT7aDMV.js";import{r as u}from"./vendor-react-CkjGjP8g.js";import{m as y,Q as g}from"./vendor-utils-BiRAyoyP.js";import{n as b}from"./nb-xAaIZxs7.js";const _=({messages:a,currentUserId:r,userProfiles:s={},isLoading:n=!1})=>{const o=u.useRef(null);u.useEffect(()=>{o.current&&o.current.scrollIntoView({behavior:"smooth"})},[a.length]);const f=v(a),h=c=>new Date(c).toLocaleTimeString("nb-NO",{hour:"2-digit",minute:"2-digit"});return e.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[n&&e.jsx("div",{className:"flex justify-center py-4",children:e.jsx(y,{className:"h-6 w-6 animate-spin text-cybergold-500"})}),Object.entries(f).map(([c,j])=>e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"flex justify-center mb-3",children:e.jsx("div",{className:"px-3 py-1 rounded text-xs bg-cyberdark-800 text-gray-400",children:N(c)})}),j.map(t=>{const l=(t.sender_id||t.senderId)===r,d=s[t.sender_id||t.senderId||""]||{username:"Unknown User",avatar_url:null},m=t.replyToId||t.reply_to_id,i=m?a.find(p=>p.id===m):null,x=i?s[i.sender_id||i.senderId||""]:null;return e.jsxs("div",{className:`flex mb-3 ${l?"justify-end":"justify-start"}`,children:[!l&&e.jsx("div",{className:"w-8 h-8 rounded-full overflow-hidden mr-2 flex-shrink-0 bg-cyberdark-800",children:d.avatar_url?e.jsx("img",{src:d.avatar_url,alt:d.username,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-cybergold-400",children:d.username.charAt(0).toUpperCase()})}),e.jsxs("div",{className:`max-w-[75%] rounded-lg p-3 ${l?"bg-cybergold-900/30 text-gray-100":"bg-cyberdark-800 text-gray-100"}`,children:[!l&&e.jsx("div",{className:"text-xs font-medium text-cybergold-400 mb-1",children:d.username}),i&&e.jsxs("div",{className:"mb-2 pl-2 border-l-2 border-cybergold-600/50",children:[e.jsx("div",{className:"text-xs text-cybergold-500 mb-0.5",children:l?"Du svarte":`Svar til ${(x==null?void 0:x.username)||"Unknown"}`}),e.jsx("div",{className:"text-xs text-gray-400 truncate",children:i.content||"Media"})]}),t.is_deleted?e.jsx("div",{className:"text-sm italic text-gray-500",children:"Denne meldingen er slettet"}):e.jsxs(e.Fragment,{children:[t.content&&e.jsx("div",{className:"text-sm break-words mb-2",children:t.content}),t.media&&e.jsx("div",{className:"rounded overflow-hidden mt-2",children:t.media.type.startsWith("image/")?e.jsx("img",{src:t.media.url,alt:"Image",className:"max-h-48 rounded"}):e.jsxs("div",{className:"p-2 bg-cyberdark-900 rounded text-xs text-gray-400",children:["[Attachment: ",t.media.type,"]"]})})]}),e.jsxs("div",{className:"flex items-center mt-1 text-xs",children:[e.jsx("span",{className:"text-gray-500",children:h(t.created_at)}),t.is_edited&&e.jsx("span",{className:"ml-1.5 text-gray-500",children:"(redigert)"}),t.isPending&&e.jsx("span",{className:"ml-1.5 text-gray-500",children:"(sender...)"}),t.hasError&&e.jsx("span",{className:"ml-1.5 text-red-500",children:"(feilet)"})]})]})]},t.id)})]},c)),!n&&a.length===0&&e.jsxs("div",{className:"h-full flex flex-col items-center justify-center",children:[e.jsx("p",{className:"text-gray-400 mb-1",children:"Ingen meldinger ennå"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Start samtalen ved å sende en melding"})]}),e.jsx("div",{ref:o})]})},v=a=>{const r={};return a.forEach(s=>{const n=new Date(s.created_at||s.createdAt||new Date).toISOString().split("T")[0];r[n]||(r[n]=[]),r[n].push(s)}),r},N=a=>{const r=new Date(a),s=new Date;s.setHours(0,0,0,0);const n=new Date(s);return n.setDate(n.getDate()-1),r.toISOString().split("T")[0]===s.toISOString().split("T")[0]?"I dag":r.toISOString().split("T")[0]===n.toISOString().split("T")[0]?"I går":g(r,{addSuffix:!0,locale:b})};export{_ as GroupMessageList};
